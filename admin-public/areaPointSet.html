<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>首页——设置</title>
    <!-- 新 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css"/>

    <script src="../js/jquery-2.1.4.min.js"></script>
    <script src="https://leancloud.cn/scripts/lib/av-0.5.1.min.js"></script>
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="../js/bootstrap.min.js"></script>

    <link href="http://cdn.bootcss.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="../jscss/summernote.css" rel="stylesheet">
    <script src="../jscss/summernote.min.js"></script>
    <script src="../jscss/summernote-ext-video.js"></script>
    <script src="../jscss/summernote-ini.js"></script>
    <script src="../jscss/summernote-zh-CN.js"></script>

    <script type="text/javascript" src="../js/common.js"></script>
    <script type="text/javascript" src="../js/indexSet.js"></script>
</head>
<body onload="loaddata();">
<SCRIPT>
    $(document).ready(function () {
        $("#foo").load("top.html");
    });
    function menuShowed() {
        $("#actMeun").removeClass("in");
        $("#userMeun").removeClass("in");
        $("#custom").removeClass("in");
        $("#articleMenu").addClass("in");
        $("#areaPoint").addClass("active");
    }
</SCRIPT>
<div role="navigation" id="foo" class="nav-collapse"></div>


<div role="main" class="main">
    <div class="box">
        <!--选项卡开始  -->
        <div role="tabpanel">
            <h3>服务区域首页文字</h3>
            <div class="tab-content">
                <div class="row min-height">
                    <div style="width:90%;">
                        <div class="editor">

                            <div id="summernote"></div>
                        </div>
                    </div>
                    <br/>
                    <button onclick="editHint()" style="float: left" class="btn btn-primary">保存提示</button>
                </div>
            </div>
        </div>

    </div>

</div>


<script type="text/javascript">
    var MyHint = AV.Object.extend("MyHint");

    /*
     * 加载出已有的数据  界面展示
     */
    function loaddata() {
        var query = new AV.Query(MyHint);
        query.get(appObjectIds.areaPointSet_objectId, {
            success: function (obj) {
                var myHtml = obj.get("content");
                console.log(myHtml);
                $('.note-editable').html(myHtml);
            },
            error: function (object, error) {
                alert("错误:" + error.message);
            }
        });
    }

    function editHint(){
        var user = AV.User.current();
        if (!user) {
            alert("您尚未登陆");
            return;
        }
        // 可以先查询出要修改的那条存储
        var query = new AV.Query(MyHint);
        query.get(appObjectIds.areaPointSet_objectId, {
            success: function(queryResult) {
                queryResult.set('content', $('.note-editable').html());
                queryResult.save(null,
                    {
                        success: function(saveResult) {
                            alert("内容已保存");
                        },
                        error: function(saveResult, error) {
                            $("#hintinfo2").html("<font color='red'>"+ error.message +"</font>");
                        }
                    }
                );
            },
            error: function(object, error) {
                // error is a AV.Error with an error code and description.
            }
        });

    }
</script>
</body>

</html>